<!DOCTYPE html>
<html>

<head>
  <title>調査項目のリスト</title>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
</head>

<body>
  <div class="container">
    <div class="col-md-4"></div>
    <div class="col-md-4">
      <h1>調査項目のリスト</h1>
      <ul id="polls"></ul>
      <a href="new.html" class="btn btn-primary">新規作成</a>
    </div>
    <div class="col-md-4"></div>
  </div>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  <script>
    $(() => {
      const update = () => {
        $.get('http://localhost:8080/polls/?key=abc123', null, null, 'json')
          .done((polls) => {
            $('#polls').empty();

            for (let poll of polls) {
              $('#polls').append(
                $('<li>').append(
                  $('<a>')
                    .attr('href', `view.html?poll=polls/${poll.id}`)
                    .text(poll.title)
                )
              );
            }
          });

        window.setTimeout(update, 10000);
      }

      update();
    });
  </script>
</body>

</html>
